var starsContainer = document.querySelector('.review_rating');    // Get the container of the Rating input
var boxReviewContent = document.querySelector('.review_content');   // Get the container of the Content input
// Content input field (textarea)
var reviewContentTextArea = document.querySelector('.review_content textarea');

// If there are any errors in the submited form, then...
<% if @review.errors.any? %>
  refreshInputValidations('.review_rating', 1, '.stars', "Rating <%= @review.errors.messages[:rating].first %>");

  var ratingErrorMessage = document.querySelector('.review_rating .invalid-feedback');

  if (ratingErrorMessage) {
    ratingErrorMessage.style.display = 'block';
    ratingErrorMessage.style.margin = '0';
  }

  refreshInputValidations('.review_content', 1, 'textarea', "Content <%= @review.errors.messages[:content].first %>");

// Otherwise, if there are no errors in the submited form...
<% else %>
  // Refresh the page Review content
  document.getElementById("reviews-list").innerHTML = "<%= j render partial: "reviews-list" %>";

  document.querySelector('#ModalNewReview button').click();     // Close Modal
  document.getElementById('review_content').value = '';         // Empty the content field

  // Clear the Rating radio boxes
  var radioBox = document.querySelectorAll('.stars input');
  for (let i = 1; i < 6; i++) {
    radioBox[i].checked = false;
  }

  // If it exists, remove any Rating and Content related error messages and validation marks
  removeErrors();
<% end %>

// Function that, if it exists, removes any Rating and Content related error messages and validation marks
function removeErrors() {
  // Remove Rating related error messages
  if (starsContainer.childElementCount > 1) {
    document.querySelector('.review_rating .invalid-feedback').remove();
  }

  // Remove Content related error messages
  if (boxReviewContent.childElementCount > 1) {
    document.querySelector('.review_content .invalid-feedback').remove();
  }

  // Remove the validation marks from the Content input field
  reviewContentTextArea.classList.remove('is-valid', 'is-invalid');
  boxReviewContent.classList.remove('form-group-valid', 'form-group-invalid');
}
